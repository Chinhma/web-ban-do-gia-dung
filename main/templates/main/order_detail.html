{% extends 'main/layout.html' %} {% load humanize %} {% block content %}

<div class="container mt-4">
  <h2>Đơn hàng #{{ order.id }}</h2>
  <p>Trạng thái: <strong>{{ order.status }}</strong></p>
  <p>Người dùng: {{ order.user.username }}</p>
  <p>Ngày: {{ order.created_at }}</p>
  <hr />
  <h5>Thông tin nhận hàng</h5>
  <p><strong>Người nhận:</strong> {{ order.recipient_name }}</p>
  <p><strong>Địa chỉ:</strong> {{ order.address }}</p>
  <p><strong>Điện thoại:</strong> {{ order.phone }}</p>
  {% if order.note %}
  <p><strong>Ghi chú:</strong> {{ order.note }}</p>
  {% endif %}

  <table class="table table-bordered">
    <thead class="thead-dark">
      <tr>
        <th>Sản phẩm</th>
        <th>Giá</th>
        <th>Số lượng</th>
        <th>Thành tiền</th>
      </tr>
    </thead>
    <tbody>
      {% for it in items %}
      <tr>
        <td>{{ it.item.product.name }}</td>
        <td>{{ it.item.price|intcomma }} đ</td>
        <td>{{ it.item.quantity }}</td>
        <td>{{ it.subtotal|intcomma }} đ</td>
      </tr>
      {% endfor %}
      <tr>
        <td colspan="3" style="text-align: right"><strong>Tổng</strong></td>
        <td><strong>{{ order.total_price|intcomma }} đ</strong></td>
      </tr>
    </tbody>
  </table>
  {% if user.is_staff %}
  <div style="margin-top: 16px">
    <form
      method="post"
      action="{% url 'main:review_order' order.id 'approve' %}"
      style="display: inline"
    >
      {% csrf_token %}
      <button class="btn btn-success">Duyệt (Approve)</button>
    </form>
    <form
      method="post"
      action="{% url 'main:review_order' order.id 'reject' %}"
      style="display: inline"
    >
      {% csrf_token %}
      <button class="btn btn-danger">Từ chối (Reject)</button>
    </form>
  </div>
  {% endif %}
</div>

{% endblock %}
